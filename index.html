<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>易凡的技术园地</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="易凡的技术园地">
<meta property="og:url" content="https://efan006.github.io/blog.github.io/index.html">
<meta property="og:site_name" content="易凡的技术园地">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="易凡的技术园地">
  
    <link rel="alternate" href="/atom.xml" title="易凡的技术园地" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">易凡的技术园地</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">时间无言，却证明一切</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://efan006.github.io/blog.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-一篇搞定Java序列化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/23/一篇搞定Java序列化/" class="article-date">
  <time datetime="2016-11-23T07:35:44.893Z" itemprop="datePublished">2016-11-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/23/一篇搞定Java序列化/">一篇搞定Java序列化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- toc -->
<ul>
<li><a href="#&#x5E8F;&#x5217;&#x5316;">&#x5E8F;&#x5217;&#x5316;</a></li>
<li><a href="#serializable">Serializable</a><ul>
<li><a href="#&#x7528;&#x6CD5;">&#x7528;&#x6CD5;</a></li>
<li><a href="#&#x4F7F;&#x7528;&#x7EC6;&#x8282;">&#x4F7F;&#x7528;&#x7EC6;&#x8282;</a></li>
</ul>
</li>
<li><a href="#parcelable">Parcelable</a><ul>
<li><a href="#&#x7279;&#x70B9;">&#x7279;&#x70B9;</a></li>
<li><a href="#&#x7528;&#x6CD5;-1">&#x7528;&#x6CD5;</a></li>
</ul>
</li>
<li><a href="#xmlextensible-markup-language">XML&#xFF08;eXtensible Markup Language&#xFF09;</a><ul>
<li><a href="#&#x7279;&#x70B9;-1">&#x7279;&#x70B9;</a></li>
<li><a href="#&#x7528;&#x6CD5;-2">&#x7528;&#x6CD5;</a></li>
<li><a href="#&#x4F7F;&#x7528;&#x7EC6;&#x8282;-1">&#x4F7F;&#x7528;&#x7EC6;&#x8282;</a></li>
</ul>
</li>
<li><a href="#jsonjavascript-object-notation">JSON&#xFF08;JavaScript Object Notation&#xFF09;</a><ul>
<li><a href="#&#x7279;&#x70B9;-2">&#x7279;&#x70B9;</a></li>
<li><a href="#fastjson-&#x4F7F;&#x7528;&#x7EC6;&#x8282;">fastjson &#x4F7F;&#x7528;&#x7EC6;&#x8282;</a></li>
<li><a href="#&#x5404;&#x79CD;json&#x5E93;&#x7684;&#x6BD4;&#x8F83;on-android">&#x5404;&#x79CD;JSON&#x5E93;&#x7684;&#x6BD4;&#x8F83;&#xFF08;on Android&#xFF09;</a></li>
</ul>
</li>
<li><a href="#protobufgoogle-protocol-buffers">Protobuf&#xFF08;Google Protocol Buffers&#xFF09;</a><ul>
<li><a href="#&#x7279;&#x70B9;-3">&#x7279;&#x70B9;</a></li>
<li><a href="#&#x7528;&#x6CD5;-3">&#x7528;&#x6CD5;</a><ul>
<li><a href="#&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;">&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;</a></li>
<li><a href="#&#x751F;&#x6210;java&#x6587;&#x4EF6;">&#x751F;&#x6210;java&#x6587;&#x4EF6;</a></li>
<li><a href="#&#x5BFC;&#x5165;jar&#x5305;">&#x5BFC;&#x5165;jar&#x5305;</a></li>
</ul>
</li>
<li><a href="#&#x6CE8;&#x610F;&#x4E8B;&#x9879;">&#x6CE8;&#x610F;&#x4E8B;&#x9879;</a></li>
<li><a href="#&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;">&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="&#x5E8F;&#x5217;&#x5316;"><a href="#&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="&#x5E8F;&#x5217;&#x5316;"></a>&#x5E8F;&#x5217;&#x5316;</h1><p>&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x548C;&#x4E8C;&#x8FDB;&#x5236;&#x4E32;&#x7684;&#x8F6C;&#x5316;&#x534F;&#x8BAE;&#xFF0C;&#x7528;&#x4E8E;&#x6570;&#x636E;&#x6301;&#x4E45;&#x5316;&#x548C;&#x6570;&#x636E;&#x4F20;&#x8F93;</p>
<h1 id="serializable"><a href="#Serializable" class="headerlink" title="Serializable"></a>Serializable</h1><h2 id="&#x7528;&#x6CD5;"><a href="#&#x7528;&#x6CD5;" class="headerlink" title="&#x7528;&#x6CD5;"></a>&#x7528;&#x6CD5;</h2><ol>
<li>&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x5B9E;&#x73B0;java.io.Serializable&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x629B;&#x51FA;NotSerializableException</li>
<li>&#x901A;&#x8FC7;ObjectOutputStream&#x548C;ObjectInputStream&#x5BF9;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(OutputStream output, T bean)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">    ObjectOutputStream oos = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> {</div><div class="line">        oos = <span class="keyword">new</span> ObjectOutputStream(output);</div><div class="line">        oos.writeObject(bean);</div><div class="line">    } <span class="keyword">catch</span> (IOException e) {</div><div class="line">        e.printStackTrace();</div><div class="line">    } <span class="keyword">finally</span> {</div><div class="line">        IOUtils.closeQuietly(oos);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">read</span><span class="params">(InputStream input, Class&lt;T&gt; entityClass)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">    ObjectInputStream ois = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> {</div><div class="line">        ois = <span class="keyword">new</span> ObjectInputStream(input);</div><div class="line">        <span class="keyword">return</span>  (T) ois.readObject();</div><div class="line">    } <span class="keyword">catch</span> (IOException | ClassNotFoundException e) {</div><div class="line">        e.printStackTrace();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    } <span class="keyword">finally</span> {</div><div class="line">        IOUtils.closeQuietly(ois);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<h2 id="&#x4F7F;&#x7528;&#x7EC6;&#x8282;"><a href="#&#x4F7F;&#x7528;&#x7EC6;&#x8282;" class="headerlink" title="&#x4F7F;&#x7528;&#x7EC6;&#x8282;"></a>&#x4F7F;&#x7528;&#x7EC6;&#x8282;</h2><ol>
<li>transient&#x5173;&#x952E;&#x5B57;&#x4FEE;&#x9970;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x963B;&#x6B62;&#x5E8F;&#x5217;&#x5316;&#x8BE5;&#x53D8;&#x91CF;&#x3002;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#xFF0C;transient &#x53D8;&#x91CF;&#x4F1A;&#x88AB;&#x8D4B;&#x503C;&#x4E3A;&#x521D;&#x59CB;&#x503C;</li>
<li>&#x5728;&#x7C7B;&#x4E2D;&#x589E;&#x52A0;writeObject &#x548C; readObject &#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x81EA;&#x5B9A;&#x4E49;&#x5E8F;&#x5217;&#x5316;&#x7B56;&#x7565;<ul>
<li>ArrayList&#x5185;&#x90E8;&#x5C31;&#x662F;&#x5C06;&#x5143;&#x7D20;transient&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x81EA;&#x5B9A;&#x4E49;writeObject&#x548C;readObject&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;ArrayList&#x662F;&#x52A8;&#x6001;&#x6570;&#x7EC4;&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5927;&#x91CF;&#x7A7A;&#x5BF9;&#x8C61;&#x88AB;&#x5E8F;&#x5217;&#x5316;</li>
<li>&#x52A0;&#x89E3;&#x5BC6;&#x5BC6;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x5728;writeObject &#x548C; readObject &#x4E2D;&#x5B9E;&#x73B0;</li>
</ul>
</li>
<li>&#x5E8F;&#x5217;&#x5316;&#x4E0D;&#x5173;&#x6CE8;&#x9759;&#x6001;&#x53D8;&#x91CF;</li>
<li>&#x7236;&#x7C7B;&#x4E0D;&#x5B9E;&#x73B0;Serializable&#x7684;&#x8BDD;&#x90A3;&#x4E48;&#x7236;&#x7C7B;&#x7684;&#x53D8;&#x91CF;&#x4E0D;&#x4F1A;&#x88AB;&#x5E8F;&#x5217;&#x5316;</li>
<li>serialVersionUID&#x4E00;&#x81F4;&#x65F6;&#x4E24;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x7C7B;&#x624D;&#x80FD;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x6210;&#x529F;&#xFF0C;&#x6CA1;&#x6709;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#x90FD;&#x7528;&#x56FA;&#x5B9A;&#x7684;1L&#x5373;&#x53EF;<ul>
<li>&#x7279;&#x6027;&#x6848;&#x4F8B;&#xFF1A;Server&#x7AEF;&#x91CD;&#x65B0;&#x751F;&#x6210;serialVersionUID&#xFF0C;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;Client&#x7AEF;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5931;&#x8D25;&#xFF0C;&#x5F3A;&#x5236;&#x5BA2;&#x6237;&#x7AEF;&#x5347;&#x7EA7;</li>
</ul>
</li>
<li><p>&#x5E8F;&#x5217;&#x5316;&#x4F1A;&#x7834;&#x574F;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;</p>
<ul>
<li><p>&#x8981;&#x4E48;&#x7528;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x7684;&#x65B9;&#x5F0F;&#x5199;&#x5355;&#x4F8B;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder</span> </span>{</div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton = <span class="keyword">new</span> Singleton();</div><div class="line">    }</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>{}</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span></span>{</div><div class="line">        <span class="keyword">return</span> Holder.singleton;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
</li>
<li><p>&#x8981;&#x4E48;&#x5355;&#x4F8B;&#x5BF9;&#x8C61;&#x91CD;&#x5199;readReslove&#x65B9;&#x6CD5;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>{}</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) {</div><div class="line">            <span class="keyword">synchronized</span> (Singleton.class) {</div><div class="line">                <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) {</div><div class="line">                    singleton = <span class="keyword">new</span> Singleton();</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> singleton;</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">return</span> singleton;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h1 id="parcelable"><a href="#Parcelable" class="headerlink" title="Parcelable"></a>Parcelable</h1><h2 id="&#x7279;&#x70B9;"><a href="#&#x7279;&#x70B9;" class="headerlink" title="&#x7279;&#x70B9;"></a>&#x7279;&#x70B9;</h2><p>Android&#x7279;&#x6709;&#xFF0C;&#x6BD4;Serializable&#x9AD8;&#x6548;&#xFF0C;&#x8282;&#x7701;&#x5185;&#x5B58;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;Intent&#x4F20;&#x9012;&#x548C;IPC&#xFF0C;&#x4F46;&#x4E0D;&#x63A8;&#x8350;&#x7528;&#x4E8E;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x56E0;&#x4E3A;&#x5B58;&#x5728;&#x7248;&#x672C;&#x5DEE;&#x5F02;</p>
<h2 id="&#x7528;&#x6CD5;"><a href="#&#x7528;&#x6CD5;-1" class="headerlink" title="&#x7528;&#x6CD5;"></a>&#x7528;&#x6CD5;</h2><ol>
<li>&#x5B9E;&#x73B0;Parcelable</li>
<li>&#x91CD;&#x5199;writeToParcel&#x548C;Parcelable.Creator&#x91CC;&#x7684;createFromParcel&#x65B9;&#x6CD5;&#xFF0C;&#x6CE8;&#x610F;&#x987A;&#x5E8F;&#x4E00;&#x5B9A;&#x8981;&#x4E00;&#x81F4;</li>
</ol>
<h1 id="xmlextensible-markup-language"><a href="#XML&#xFF08;eXtensible-Markup-Language&#xFF09;" class="headerlink" title="XML&#xFF08;eXtensible Markup Language&#xFF09;"></a>XML&#xFF08;eXtensible Markup Language&#xFF09;</h1><h2 id="&#x7279;&#x70B9;"><a href="#&#x7279;&#x70B9;-1" class="headerlink" title="&#x7279;&#x70B9;"></a>&#x7279;&#x70B9;</h2><ol>
<li>XML&#x88AB;&#x8BBE;&#x8BA1;&#x4E3A;&#x4F20;&#x8F93;&#x548C;&#x5B58;&#x50A8;&#x6570;&#x636E;&#xFF0C;W3C&#x6807;&#x51C6;</li>
<li>&#x5177;&#x6709;&#x81EA;&#x6211;&#x63CF;&#x8FF0;&#x6027;&#xFF0C;&#x4F46;&#x4EC5;&#x4EC5;&#x662F;&#x7EAF;&#x6587;&#x672C;&#xFF0C;&#x4E0D;&#x4F1A;&#x5904;&#x7406;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5; </li>
</ol>
<h2 id="&#x7528;&#x6CD5;"><a href="#&#x7528;&#x6CD5;-2" class="headerlink" title="&#x7528;&#x6CD5;"></a>&#x7528;&#x6CD5;</h2><ol>
<li>&#x57FA;&#x4E8E;&#x4E8B;&#x4EF6;&#x9A71;&#x52A8;&#x7684;SAX&#x3001;Pull&#x65B9;&#x5F0F;&#xFF0C;&#x5185;&#x5B58;&#x5360;&#x7528;&#x5C11;&#xFF0C;&#x4F7F;&#x7528;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x8FD8;&#x6709;&#x628A;XML&#x5168;&#x90E8;&#x52A0;&#x8F7D;&#x6210;&#x6811;&#x7ED3;&#x6784;&#x7684;DOM&#x65B9;&#x5F0F;&#xFF0C;&#x4F7F;&#x7528;&#x7075;&#x6D3B;&#x4F46;&#x5185;&#x5B58;&#x5360;&#x7528;&#x591A;</li>
<li>&#x6211;&#x6BD4;&#x8F83;&#x61D2;&#xFF0C;&#x76F4;&#x63A5;&#x7528;&#x4E86;Square Retrofit&#x91CC;&#x7684;XML&#x89E3;&#x6790;&#x5668;-SimpleXML&#xFF0C;&#x4F7F;&#x7528;&#x5C31;&#x50CF;JSON&#x4E00;&#x6837;&#x7B80;&#x5355;<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlConverter</span> <span class="keyword">implements</span> <span class="title">IConverter</span> </span>{</div><div class="line"> </div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Serializer serializer = <span class="keyword">new</span> Persister();</div><div class="line"> </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">String <span class="title">toString</span><span class="params">(T bean)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">        ByteArrayOutputStream output = <span class="keyword">new</span> ByteArrayOutputStream();</div><div class="line">        write(output, bean);</div><div class="line">        <span class="keyword">return</span> output.toString();</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">toBean</span><span class="params">(String string, Class&lt;T&gt; entityClass)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">        <span class="keyword">if</span> (entityClass == String.class</div><div class="line">                || entityClass == CharSequence.class){</div><div class="line">            <span class="keyword">return</span> (T)string;</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (entityClass == <span class="keyword">char</span>[].class){</div><div class="line">            <span class="keyword">return</span> (T)string.toCharArray();</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="keyword">return</span> serializer.read(entityClass, string);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(OutputStream output, T bean)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">        serializer.write(bean, output);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">read</span><span class="params">(InputStream input, Class&lt;T&gt; entityClass)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">        <span class="keyword">return</span> serializer.read(entityClass, input);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="&#x4F7F;&#x7528;&#x7EC6;&#x8282;"><a href="#&#x4F7F;&#x7528;&#x7EC6;&#x8282;-1" class="headerlink" title="&#x4F7F;&#x7528;&#x7EC6;&#x8282;"></a>&#x4F7F;&#x7528;&#x7EC6;&#x8282;</h2><p>&#x67D0;&#x4E9B;&#x6587;&#x672C;&#xFF0C;&#x6BD4;&#x5982; JavaScript &#x4EE3;&#x7801;&#xFF0C;&#x5305;&#x542B;&#x5927;&#x91CF; &#x201C;&lt;&#x201D; &#x6216; &#x201C;&amp;&#x201D; &#x5B57;&#x7B26;&#x3002;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x9519;&#x8BEF;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x811A;&#x672C;&#x4EE3;&#x7801;&#x5B9A;&#x4E49;&#x4E3A; CDATA&#x3002;CDATA &#x90E8;&#x5206;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x90FD;&#x4F1A;&#x88AB;&#x89E3;&#x6790;&#x5668;&#x5FFD;&#x7565;&#x3002;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//CDATA  &#x7531; &lt;![CDATA[ &#x5F00;&#x59CB;&#xFF0C;&#x7531; ]]&gt; &#x7ED3;&#x675F;</div><div class="line">//&#x4EE5;&#x4E0B;&#x4E94;&#x79CD;&#x7B26;&#x53F7;&#x9700;&#x8981;&#x505A;&#x8F6C;&#x4E49;</div><div class="line">&amp;lt;        &lt;   &#x5C0F;&#x4E8E;</div><div class="line">&amp;gt;        &gt;   &#x5927;&#x4E8E;</div><div class="line">&amp;amp;       &amp;   &#x548C;&#x53F7;</div><div class="line">&amp;apos;      &apos;   &#x7701;&#x7565;&#x53F7;</div><div class="line">&amp;quot;      &quot;   &#x5F15;&#x53F7;</div></pre></td></tr></table></figure></p>
<h1 id="jsonjavascript-object-notation"><a href="#JSON&#xFF08;JavaScript-Object-Notation&#xFF09;" class="headerlink" title="JSON&#xFF08;JavaScript Object Notation&#xFF09;"></a>JSON&#xFF08;JavaScript Object Notation&#xFF09;</h1><h2 id="&#x7279;&#x70B9;"><a href="#&#x7279;&#x70B9;-2" class="headerlink" title="&#x7279;&#x70B9;"></a>&#x7279;&#x70B9;</h2><ol>
<li>&#x7528;&#x201C;&#x5C5E;&#x6027;-&#x503C;&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x63CF;&#x8FF0;&#x5BF9;&#x8C61;&#xFF0C;&#x4FDD;&#x6301;&#x4E86;&#x4EBA;&#x773C;&#x53EF;&#x8BFB;&#x7684;&#x4F18;&#x70B9;</li>
<li>&#x76F8;&#x6BD4;XML&#x6570;&#x636E;&#x66F4;&#x52A0;&#x7B80;&#x6D01;(&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x5C06;&#x8FD1;&#x4E00;&#x534A;)&#xFF0C;&#x89E3;&#x6790;&#x66F4;&#x5FEB;</li>
<li>JS&#x7684;&#x5148;&#x5929;&#x652F;&#x6301;&#xFF0C;&#x5E7F;&#x6CDB;&#x5E94;&#x7528;&#x4E8E;web browser&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x6709;&#x826F;&#x597D;&#x7684;&#x6269;&#x5C55;&#x6027;&#x548C;&#x517C;&#x5BB9;&#x6027;</li>
</ol>
<h2 id="fastjson-&#x4F7F;&#x7528;&#x7EC6;&#x8282;"><a href="#fastjson-&#x4F7F;&#x7528;&#x7EC6;&#x8282;" class="headerlink" title="fastjson &#x4F7F;&#x7528;&#x7EC6;&#x8282;"></a>fastjson &#x4F7F;&#x7528;&#x7EC6;&#x8282;</h2><ol>
<li>&#x8981;&#x6709;&#x9ED8;&#x8BA4;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF0C;&#x6216;&#x8005;&#x6709;@JSONCreator&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x7136;&#x4F1A;&#x62A5;JSONException</li>
<li>&#x8981;&#x6709;&#x6210;&#x5458;&#x8981;public&#x6216;&#x8005;&#x8981;&#x6709;get/set&#x65B9;&#x6CD5;(&#x6211;&#x4EEC;&#x5DE5;&#x7A0B;&#x7EA6;&#x5B9A;&#x7EDF;&#x4E00;&#x7528;get/set&#x65B9;&#x6CD5;)&#xFF0C;&#x4E0D;&#x7136;&#x89E3;&#x6790;&#x4E0D;&#x5230;</li>
<li>&#x7528;@JSONField(name=&#x201D;xxx&#x201D;)&#x6307;&#x5B9A;key&#x540D;&#x5B57;&#xFF0C;&#x4E0D;&#x6307;&#x5B9A;&#x7684;&#x8BDD;&#x91C7;&#x7528;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;&#x5BFC;&#x81F4;&#x89E3;&#x6790;&#x9519;&#x8BEF;</li>
<li>&#x7528;@JSONField(format=&#x201D;yyyyMMdd&#x201D;)&#x914D;&#x7F6E;&#x65E5;&#x671F;&#x683C;&#x5F0F;</li>
<li>&#x6709;&#x4E9B;&#x573A;&#x666F;&#x5C5E;&#x6027;&#x4E92;&#x76F8;&#x4F9D;&#x8D56;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x505A;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;@JSONCreator&#x6765;&#x6307;&#x5B9A;&#x6784;&#x9020;&#x51FD;&#x6570;<ul>
<li>@JSONCreator&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;</li>
<li>&#x53C2;&#x6570;&#x5FC5;&#x987B;&#x6DFB;&#x52A0;&#x6CE8;&#x89E3;@JSONField(name=&#x201D;xxx&#x201D;)</li>
<li>&#x5B50;&#x7C7B;&#x7684;@JSONCreator&#x4E0D;&#x4F1A;&#x7EE7;&#x627F;&#x7236;&#x7C7B;&#x7684;@JSONCreator</li>
</ul>
</li>
<li>&#x6709;&#x4E9B;&#x573A;&#x666F;&#x5C5E;&#x6027;&#x76F8;&#x4E92;&#x4F9D;&#x8D56;&#xFF0C;&#x9700;&#x8981;&#x5728;bean&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x5BF9;&#x6570;&#x636E;&#x505A;&#x4E8C;&#x6B21;&#x5904;&#x7406;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7C7B;&#x5B9E;&#x73B0;JavaBeanDeserializerListener&#xFF0C;&#x5728;onDeserializerSuccess&#x505A;&#x4E8C;&#x6B21;&#x5904;&#x7406;</li>
<li>&#x5E8F;&#x5217;&#x5316;&#x9ED8;&#x8BA4;&#x8DF3;&#x8FC7;null&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x518D;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x6CD5;&#x91CC;&#x4F20;SerializerFeature WriteMapNullValue&#xFF1A;&#x662F;&#x5426;&#x8F93;&#x51FA;&#x503C;&#x4E3A;null&#x7684;&#x5B57;&#x6BB5;,&#x9ED8;&#x8BA4;&#x4E3A;false<br>&#x8FD8;&#x6709;&#x5176;&#x4ED6;feature&#xFF1A;<ul>
<li>QuoteFieldNames          &#x8F93;&#x51FA;key&#x65F6;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x53CC;&#x5F15;&#x53F7;,&#x9ED8;&#x8BA4;&#x4E3A;true   </li>
<li>WriteNullNumberAsZero    &#x6570;&#x503C;&#x5B57;&#x6BB5;&#x5982;&#x679C;&#x4E3A;null,&#x8F93;&#x51FA;&#x4E3A;0,&#x800C;&#x975E;null   </li>
<li>WriteNullListAsEmpty     List&#x5B57;&#x6BB5;&#x5982;&#x679C;&#x4E3A;null,&#x8F93;&#x51FA;&#x4E3A;[],&#x800C;&#x975E;null   </li>
<li>WriteNullStringAsEmpty   &#x5B57;&#x7B26;&#x7C7B;&#x578B;&#x5B57;&#x6BB5;&#x5982;&#x679C;&#x4E3A;null,&#x8F93;&#x51FA;&#x4E3A;&#x201D;&#x201D;,&#x800C;&#x975E;null   </li>
<li>WriteNullBooleanAsFalse  Boolean&#x5B57;&#x6BB5;&#x5982;&#x679C;&#x4E3A;null,&#x8F93;&#x51FA;&#x4E3A;false,&#x800C;&#x975E;null </li>
</ul>
</li>
<li>&#x987A;&#x5E8F;&#x95EE;&#x9898;<ul>
<li>&#x6570;&#x7EC4;&#x548C;List&#x4E0D;&#x4F1A;&#x4E71;&#x5E8F;</li>
<li>&#x5728;1.1.26&#x7248;&#x672C; JSONObject&#x548C;Bean&#x5E8F;&#x5217;&#x5316;&#x540E;&#x4F1A;&#x4E71;&#x5E8F;&#xFF0C;</li>
<li>&#x5728;1.1.41&#x4F1A;&#x6309;key&#x7684;&#x987A;&#x5E8F;&#x91CD;&#x65B0;&#x6392;&#x5E8F;&#xFF0C;</li>
<li>&#x5728;1.1.42&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;@JSONField(ordinal = 1)&#x6307;&#x5B9A;&#x987A;&#x5E8F;</li>
<li>&#x8FD8;&#x53EF;&#x4EE5;&#x5728;&#x7C7B;&#x4E0A;&#x914D;&#x7F6E;@JSONType(orders = {})&#x6765;&#x8BBE;&#x7F6E;&#x987A;&#x5E8F;</li>
</ul>
</li>
<li>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x9047;&#x5230;&#x91CD;&#x590D;&#x7684;key&#xFF0C;&#x4EE5;&#x540E;&#x9762;&#x7684;&#x4E3A;&#x51C6;</li>
</ol>
<h2 id="&#x5404;&#x79CD;json&#x5E93;&#x7684;&#x6BD4;&#x8F83;on-android"><a href="#&#x5404;&#x79CD;JSON&#x5E93;&#x7684;&#x6BD4;&#x8F83;&#xFF08;on-Android&#xFF09;" class="headerlink" title="&#x5404;&#x79CD;JSON&#x5E93;&#x7684;&#x6BD4;&#x8F83;&#xFF08;on Android&#xFF09;"></a>&#x5404;&#x79CD;JSON&#x5E93;&#x7684;&#x6BD4;&#x8F83;&#xFF08;on Android&#xFF09;</h2><ul>
<li>&#x4F9D;&#x8D56;&#x6BD4;&#x8F83;&#xFF1A; fastjson(202K) &lt; gson(226K) &lt; jackson(33+190+828=1051K)</li>
<li>&#x6D41;&#x884C;&#x5EA6;&#xFF1A; gson &gt; fastjson &gt; jackson  //p.s. fastjson&#x4EC5;&#x5728;&#x4E2D;&#x56FD;&#x6D41;&#x884C;</li>
<li>&#x901F;&#x5EA6;&#x6BD4;&#x8F83;&#xFF1A;&#x5C0F;&#x6570;&#x636E;&#x91CF;&#x4E0A;fastjson&#x548C;gson&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x4F18;&#x4E8E;jackson&#xFF1B;&#x5927;&#x6570;&#x636E;&#x91CF;&#x4E0A;&#xFF0C;fastjson&#x548C;jackson&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;gson&#x5F88;&#x5DEE;<ul>
<li>p.s. fastjson&#x5728;jvm&#x5E73;&#x53F0;&#x4E0A;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x5728;Android&#x4E0A;&#x4F18;&#x79C0;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD0;&#x7528;&#x4E86;ASM&#x5E93;</li>
</ul>
</li>
<li>&#x7528;&#x6CD5;&#x6BD4;&#x8F83;&#xFF1A;<ul>
<li>fastjson&#xFF1A;<ol>
<li>&#x5BF9;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x3001;get/set&#x65B9;&#x6CD5;&#x7684;&#x89C4;&#x8303;&#x6BD4;&#x8F83;&#x591A;&#xFF08;&#x89C1;&#x4E0A;&#x6587;&#xFF09;&#xFF0C;&#x4E0D;&#x7559;&#x795E;&#x5BB9;&#x6613;&#x9047;&#x5230;&#x5751;</li>
<li>&#x65E7;&#x7248;&#x672C;bug&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x6700;&#x597D;&#x4F7F;&#x7528;&#x6700;&#x65B0;&#x7248;        </li>
</ol>
</li>
<li>gson&#xFF1A;<ol>
<li>&#x7C7B;&#x578B;&#x4E0D;&#x5BF9;&#x4E0D;&#x62A5;&#x9519;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x9ED8;&#x8BA4;&#x503C;</li>
<li>&#x9ED8;&#x8BA4;&#x4E0D;&#x5E8F;&#x5217;&#x5316;null&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x5E8F;&#x5217;&#x5316;&#xFF1A;Gson gson = new GsonBuilder().serializeNulls().create();  </li>
<li>&#x5982;&#x679C;&#x9700;&#x8981;&#x53CD;&#x5E8F;&#x5217;&#x5316;null&#x4E3A;&#x201D;&#x201D;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x518C;TypeAdapter&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x53CD;&#x5E8F;&#x5217;&#x5316;null&#x4E3A;&#x7A7A;list&#xFF0C;&#x9700;&#x8981;&#x6DFB;&#x52A0;@JsonAdapter&#x6CE8;&#x89E3;(&#x53EF;&#x53C2;&#x8003;&#x6211;&#x9488;&#x5BF9;&#x8FD9;&#x4E2A;&#x5199;&#x7684;&#x4E00;&#x7BC7;<a href="http://blog.csdn.net/efan006/article/details/50544509" target="_blank" rel="external">&#x535A;&#x5BA2;&#x65E5;&#x5FD7;</a>)</li>
</ol>
</li>
<li>jackson&#xFF1A;&#x5E8F;&#x5217;&#x5316;&#x9ED8;&#x8BA4;&#x4E0D;&#x4F1A;&#x8DF3;&#x8FC7;null&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x8DF3;&#x8FC7;<ul>
<li>&#x53EF;&#x4EE5;&#x5728;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x4E0A;&#x4F7F;&#x7528;@JsonInclude(Include.NON_NULL)</li>
<li>&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x6CD5;&#x4E0A;mapper.setSerializationInclusion(Include.NON_NULL);  </li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="protobufgoogle-protocol-buffers"><a href="#Protobuf&#xFF08;Google-Protocol-Buffers&#xFF09;" class="headerlink" title="Protobuf&#xFF08;Google Protocol Buffers&#xFF09;"></a>Protobuf&#xFF08;Google Protocol Buffers&#xFF09;</h1><h2 id="&#x7279;&#x70B9;"><a href="#&#x7279;&#x70B9;-3" class="headerlink" title="&#x7279;&#x70B9;"></a>&#x7279;&#x70B9;</h2><ol>
<li>Google&#x5F00;&#x53D1;&#x7684;&#x4E00;&#x79CD;&#x8F7B;&#x4FBF;&#x9AD8;&#x6548;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x683C;&#x5F0F;, &#x9002;&#x5408;&#x5185;&#x90E8;&#x5BF9;&#x6027;&#x80FD;&#x8981;&#x6C42;&#x9AD8;&#x7684;RPC&#x8C03;&#x7528;</li>
<li>&#x7279;&#x70B9;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x683C;&#x5F0F;&#xFF0C;&#x6570;&#x636E;&#x91CF;&#x5C0F;&#xFF08;&#x76F8;&#x5F53;&#x4E8E;json&#x7684;40%&#x5DE6;&#x53F3;&#xFF09;&#xFF0C;&#x89E3;&#x5305;&#x901F;&#x5EA6;&#x5FEB;&#xFF0C;&#x975E;&#x5E38;&#x9002;&#x5408;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6216;&#x4EA4;&#x6362;</li>
<li>proto2&#x4EC5;&#x652F;&#x6301;Java&#xFF0C;C++&#xFF0C;Python&#x4E09;&#x79CD;&#x8BED;&#x8A00;, proto3&#x8FD8;&#x652F;&#x6301;JavaScript, Objective-C, Ruby, C#, Go.</li>
</ol>
<h2 id="&#x7528;&#x6CD5;"><a href="#&#x7528;&#x6CD5;-3" class="headerlink" title="&#x7528;&#x6CD5;"></a>&#x7528;&#x6CD5;</h2><h3 id="&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;"><a href="#&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;" class="headerlink" title="&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;"></a>&#x5199;proto&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7ED3;&#x6784;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">//&#x53EF;&#x4EE5;&#x5199;&#x6CE8;&#x91CA;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x8F6C;&#x5230;java&#x7C7B;&#x91CC;</div><div class="line"></div><div class="line">import &quot;xxx.proto&quot;                                      //import&#x8868;&#x793A;&#x4F9D;&#x8D56;&#x5176;&#x4ED6;proto&#x6587;&#x4EF6;</div><div class="line">option java_package = &quot;com.fs.fsprobuf&quot;;                //java_package &#x4EE3;&#x8868;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x5305;&#x540D;</div><div class="line">option java_outer_classname = &quot;User&quot;;                   //java_outer_classname &#x5373;&#x4E3A;&#x7C7B;&#x540D;</div><div class="line"></div><div class="line">message Person {                                        //message&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x7C7B;</div><div class="line">    </div><div class="line">    enum PhoneType{                                     //enum&#x662F;&#x4E00;&#x4E2A;&#x679A;&#x4E3E;&#x7C7B;&#x578B;</div><div class="line">        MOBILE = 0;                                     </div><div class="line">        HOME = 1;</div><div class="line">        WORK = 2;</div><div class="line">    }</div><div class="line"></div><div class="line">    message PhoneNumber{</div><div class="line">        required string number = 1;                     //required &#x4EE3;&#x8868;&#x8BE5;&#x5B57;&#x6BB5;&#x5FC5;&#x586B;&#xFF0C;&#x6CA1;&#x4F20;&#x503C;&#x4F1A;&#x62A5;&#x9519;</div><div class="line">        optional PhoneType type = 2[default = HOME]     //optional &#x4EE3;&#x8868;&#x8BE5;&#x5B57;&#x6BB5;&#x53EF;&#x9009;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x4E3A;&#x5176;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x683C;&#x5F0F;[defalut=]&#x3002;</div><div class="line">    }</div><div class="line"></div><div class="line">    required int32 id = 2;                              //&#x6574;&#x578B;int32 &#x5E03;&#x5C14;&#x503C;bool</div><div class="line">    required string name = 1;                           //required int32 userId = 1 (&#x4FEE;&#x9970;&#x8BCD; &#x7C7B;&#x578B; &#x57DF;&#x540D; = &#x6807;&#x8BB0;&#x503C;)&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x57DF; </div><div class="line">    optional string email = 3[default=&quot;123&quot;];           //&#x6807;&#x8BB0;&#x503C;&#x662F;&#x7528;&#x6765;&#x5728;&#x4E8C;&#x8FDB;&#x5236;&#x7F16;&#x7801;&#x91CC;&#x552F;&#x4E00;&#x786E;&#x8BA4;&#x5F53;&#x524D;&#x57DF;&#x7684;</div><div class="line">    repeated PhoneNumber phone = 4;                     //repeated &#x4EE3;&#x8868;&#x4E00;&#x4E2A;list</div><div class="line">}</div></pre></td></tr></table></figure>
<h3 id="&#x751F;&#x6210;java&#x6587;&#x4EF6;"><a href="#&#x751F;&#x6210;java&#x6587;&#x4EF6;" class="headerlink" title="&#x751F;&#x6210;java&#x6587;&#x4EF6;"></a>&#x751F;&#x6210;java&#x6587;&#x4EF6;</h3><p>&#x4F7F;&#x7528;&#x5B98;&#x65B9;&#x5DE5;&#x5177;&#x628A;proto&#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x6210;java&#x6587;&#x4EF6;&#xFF0C;&#x653E;&#x5230;&#x5DE5;&#x7A0B;&#x91CC;&#x4E0E;package&#x5BF9;&#x5E94;&#x7684;&#x8DEF;&#x5F84;&#x4E0B;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">protoc-java.exe --java_out=./ *.proto</div></pre></td></tr></table></figure></p>
<h3 id="&#x5BFC;&#x5165;jar&#x5305;"><a href="#&#x5BFC;&#x5165;jar&#x5305;" class="headerlink" title="&#x5BFC;&#x5165;jar&#x5305;"></a>&#x5BFC;&#x5165;jar&#x5305;</h3><p>&#x4E0B;&#x8F7D;&#x5B98;&#x65B9;&#x7684;protobuf-java&#x7684;jar&#x5305;&#x5F15;&#x5165;&#x5230;&#x5DE5;&#x7A0B;&#x91CC;&#xFF0C;&#x4F7F;&#x7528;&#x5DE5;&#x5177;&#x7C7B;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x8BFB;&#x5199;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@overide</span></div><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(OutputStream output, T bean)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">    <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> MessageLite){</div><div class="line">        ((MessageLite)bean).writeTo(output);</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(bean.getClass().getName() + <span class="string">&quot;is not a protobuf message&quot;</span>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="meta">@overide</span></div><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">read</span><span class="params">(InputStream input, Class&lt;T&gt; entityClass)</span> <span class="keyword">throws</span> Exception </span>{</div><div class="line">    <span class="keyword">if</span> (MessageLite.class.isAssignableFrom(entityClass)) {</div><div class="line">        Parser&lt;MessageLite&gt; parser;</div><div class="line">        <span class="keyword">try</span> {</div><div class="line">            Field field = entityClass.getDeclaredField(<span class="string">&quot;PARSER&quot;</span>);</div><div class="line">            parser = (Parser&lt;MessageLite&gt;) field.get(<span class="keyword">null</span>);</div><div class="line">            <span class="keyword">return</span> (T)parser.parseFrom(input);</div><div class="line">        } <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e) {</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</div><div class="line">                    <span class="string">&quot;Found a protobuf message but &quot;</span> + entityClass.getName() + <span class="string">&quot; had no PARSER field.&quot;</span>);</div><div class="line">        }</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(entityClass.getName() + <span class="string">&quot;is not a protobuf message&quot;</span>);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<h2 id="&#x6CE8;&#x610F;&#x4E8B;&#x9879;"><a href="#&#x6CE8;&#x610F;&#x4E8B;&#x9879;" class="headerlink" title="&#x6CE8;&#x610F;&#x4E8B;&#x9879;"></a>&#x6CE8;&#x610F;&#x4E8B;&#x9879;</h2><ol>
<li>&#x5347;&#x7EA7;proto&#x5B9A;&#x4E49;&#xFF0C;&#x4E0D;&#x53EF;&#x4FEE;&#x6539;&#x73B0;&#x6709;&#x57DF;&#x7684;&#x6807;&#x8BB0;&#x503C;&#xFF0C;&#x4E0D;&#x53EF;&#x6DFB;&#x52A0;/&#x5220;&#x9664;required&#x57DF;&#x3002;&#x53EF;&#x4EE5;&#x5220;&#x9664;optional&#xFF0C;repeated&#x57DF;&#x3002;&#x6DFB;&#x52A0;optional&#xFF0C;repeated&#x57DF;&#x5FC5;&#x987B;&#x91C7;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x6807;&#x8BB0;&#x503C;&#xFF08;&#x4E4B;&#x524D;&#x5220;&#x9664;&#x8FC7;&#x7684;&#x4E5F;&#x4E0D;&#x80FD;&#x7528;&#xFF09;</li>
<li>proto&#x6587;&#x4EF6;&#x8F6C;&#x6210;&#x7684;java&#x7C7B; &#x5E26;&#x6709;&#x5927;&#x91CF;&#x7684;&#x65B9;&#x6CD5;(&#x5B9E;&#x6D4B;&#x4EC5;3&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x7C7B;&#xFF0C;&#x751F;&#x6210;&#x4E86;&#x8FD1;100&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;800&#x884C;&#x4EE3;&#x7801;)&#x3002;&#x8FD9;&#x5728;Android&#x4E0A;&#x6781;&#x6613;&#x5BFC;&#x81F4;&#x65B9;&#x6CD5;&#x6570;&#x8D85;65535&#x4E0A;&#x9650;</li>
</ol>
<h2 id="&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;"><a href="#&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;" class="headerlink" title="&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;"></a>&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;</h2><p>&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x91C7;&#x7528;Square Wire &#x9879;&#x76EE;&#x7684;proto&#x5DE5;&#x5177;  </p>
<ol>
<li>&#x9996;&#x5148;&#x4E5F;&#x662F;&#x5199;proto&#x6587;&#x4EF6;&#xFF0C;&#x4E00;&#x6837;&#x7684;  </li>
<li>&#x5728;&#x9879;&#x76EE;gradle&#x91CC;&#x5F15;&#x5165;wire&#x7EC4;&#x4EF6;<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">compile</span> <span class="string">&apos;com.squareup.wire:wire-runtime:2.2.0&apos;</span>   </div><div class="line">``` </div><div class="line"><span class="number">3</span>. &#x7136;&#x540E;&#x4E0B;&#x8F7D;wire-compiler-VERSION-jar-with-<span class="keyword">dependencies</span>.jar&#x5DE5;&#x5177;&#xFF0C;&#x8FD9;&#x4E2A;&#x9700;&#x8981;&#x53BB;maven&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;[&#x4E0B;&#x8F7D;&#x5730;&#x5740;](http:<span class="comment">//search.maven.org/#search|ga|1|g%3A%22com.squareup.wire%22) &#x6CE8;&#x610F;&#x8981;&#x9009;&#x62E9;&#x4E0E;gradle&#x5F15;&#x5165;&#x7684;wire&#x7248;&#x672C;&#x4E00;&#x81F4;</span></div><div class="line"><span class="number">4</span>. &#x4F7F;&#x7528;cmd&#x6267;&#x884C;&#x547D;&#x4EE4;&#x751F;&#x6210;java&#x6587;&#x4EF6;   </div><div class="line">```   </div><div class="line">java -jar -Dfile.encoding=UTF-<span class="number">8</span> wire-compiler-<span class="number">2.2</span>.<span class="number">0</span>-jar-with-<span class="keyword">dependencies</span>.jar --proto_path=. --java_out=. *.proto  </div><div class="line">```   </div><div class="line"><span class="number">5</span>. &#x4F7F;&#x7528;&#x5DE5;&#x5177;&#x7C7B;&#x8BFB;&#x5199;</div><div class="line">``` java</div><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="keyword">void</span> <span class="keyword">write</span>(OutputStream output, T bean) <span class="keyword">throws</span> Exception {</div><div class="line">        <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> Message){</div><div class="line">            ((Message)bean).encode(output);</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(bean.getClass().getName() + <span class="string">&quot; is not a protobuf message&quot;</span>);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    @Override</div><div class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="keyword">read</span>(InputStream input, <span class="keyword">Class</span>&lt;T&gt; entityClass) <span class="keyword">throws</span> Exception {</div><div class="line">        <span class="keyword">if</span> (Message.<span class="keyword">class</span>.isAssignableFrom(entityClass)) {</div><div class="line">            ProtoAdapter&lt;Message&gt; adapter;</div><div class="line">            <span class="keyword">try</span> {</div><div class="line">                Field field = entityClass.getDeclaredField(<span class="string">&quot;ADAPTER&quot;</span>);</div><div class="line">                adapter = (ProtoAdapter&lt;Message&gt;)field.get(<span class="keyword">null</span>);</div><div class="line">                <span class="keyword">return</span> (T)adapter.decode(input);</div><div class="line">            } <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e) {</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</div><div class="line">                        <span class="string">&quot;Found a protobuf message but &quot;</span> + entityClass.getName() + <span class="string">&quot; had no ADAPTER field.&quot;</span>);</div><div class="line">            }</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(entityClass.getName() + <span class="string">&quot; is not a protobuf message&quot;</span>);</div><div class="line">        }</div><div class="line">    }</div></pre></td></tr></table></figure>
</li>
</ol>
<p>&#x4F7F;&#x7528;wire&#x9879;&#x76EE;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x65B9;&#x6CD5;&#x6570;&#x663E;&#x8457;&#x88C1;&#x526A;&#x4E86;&#xFF08;&#x8FD8;&#x662F;&#x4E4B;&#x524D;3&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x7C7B;&#xFF0C;&#x65B9;&#x6CD5;20&#x591A;&#x4E2A;&#xFF0C;188&#x884C;&#x4EE3;&#x7801;&#xFF09;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://efan006.github.io/blog.github.io/2016/11/23/一篇搞定Java序列化/" data-id="civungstt00015cfyfbkcgrxz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/23/hello-world/" class="article-date">
  <time datetime="2016-11-23T07:06:07.685Z" itemprop="datePublished">2016-11-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/23/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="quick-start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://efan006.github.io/blog.github.io/2016/11/23/hello-world/" data-id="civungstn00005cfyvxcwr14v" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/23/一篇搞定Java序列化/">一篇搞定Java序列化</a>
          </li>
        
          <li>
            <a href="/2016/11/23/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 efan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>